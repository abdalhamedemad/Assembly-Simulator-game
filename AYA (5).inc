 CSHIFTROTMACRO MACRO 
 CMP DESTINATIONSELECTOR,1H
        JZ REGISTERDESTSHA202
        
  CMP DESTINATIONSELECTOR,0H ; MOV [2],(AX)
  JZ  MAEMORYDESTSH      
           
   
MAEMORYDESTSH: 
  CMP SOURCESELECTOR,3H
  JZ ERRORSHA102            ;memory to memory
   
   ;//////////////////////////  mov(bx,0005
   lea di,commands
   mov al,asciidestsum
   cmp BYTE PTR [di+5],28h ; register addressing mode  mean we don't need to convert from ascii to degitss
   jz EXITT555SH  
   CMP AL,3AH
       JC DIGIT11SH
       JMP LETTER13SH
      
       
       DIGIT11SH:
       SUB AL,30H
     ;  MOV [DI],AL
      
     
       JMP EXITT555SH
       
       
       LETTER13SH:
       CMP AL,'A'
       JNZ B11SH
       MOV AL,0AH
       JMP EXITT555SH 
       
       B11SH:
       CMP AL,'B'
       JNZ C11SH
       MOV AL,0BH  
       JMP EXITT555SH 
        
        C11SH:
       CMP AL,'C'
       JNZ D11SH
       MOV AL,0CH
       JMP EXITT555SH 
        
         D11SH:
       CMP AL,'D'
       JNZ E11SH
       MOV AL,0DH
       JMP EXITT555SH 
        
         E11SH:
       CMP AL,'E'
       JNZ F11SH
       MOV AL,0EH 
         JMP  EXITT555SH 
          F11SH :
       MOV AL,0FH
       JMP  EXITT555SH 
  
ERRORSHA102:
JMP ERRORSHA101  
REGISTERDESTSHA202:
JMP REGISTERDESTSHA201  
  
EXITT555SH:
    mov asciidestsum,al
      ;//////////////////////////////
  CMP SOURCEHIN,8H    ; 8-> VALUE 8 BIT  16-> VLAUE 16 REG OR 16 BIT VALUE  17-> 8 BIT REG
    
  JZ VALUESH
  
   CMP SOURCEHIN,17H 
    
   JZ REGISH
   JNZ  ERRORSHA101
   
VALUESH:   
     LEA DI, MEMORYPLAYER
     MOV  AL, asciidestsum
     MOV AH,0H  
   ;////////////////////////////////////////////
   
   
   ;/////////////////////////////////////////////  
     ADD DI,AX
     MOV CL,BYTE PTR FINALSOURCE

;//////////////////////////////////////////////////
  LEA SI,asciisum
     
     cmp BYTE PTR [SI],0EDH
     JZ SHIFTRIGHTV
     
     CMP BYTE PTR [SI],0E7H
     JZ SHIFTLEFTV   
     
      CMP BYTE PTR [SI],0EFH
     JZ ROTATERIGHTV
     
      CMP BYTE PTR [SI],0F0H
     JZ ROTATELEFTV 
     
     CMP BYTE PTR [SI],0E1H
     JZ ROTATELEFTWITHCARRYV
     
     CMP BYTE PTR [SI],0E5H
     JZ ROTATERIGHTWITHCARRYV
     
     CMP BYTE PTR [SI],0E6H
     JZ SHIFTARITHMATICRIGHTV 
     
SHIFTRIGHTV:
POPF
    SHR BYTE PTR [DI],CL
         
	 PUSHF
         JMP CEXSH
SHIFTLEFTV:
POPF

    SHL BYTE PTR [DI],CL

	 PUSHF
         JMP CEXSH
ROTATERIGHTV:
POPF

    ROR BYTE PTR [DI],CL
    
	   
	 PUSHF
         JMP   CEXSH  
ROTATELEFTV:
POPF

    ROL BYTE PTR [DI],CL
    
	  
	 PUSHF
         JMP   CEXSH     
ROTATELEFTWITHCARRYV:
POPF

    RCL BYTE PTR [DI],CL
                             
 
	 PUSHF
         JMP  CEXSH                      
ROTATERIGHTWITHCARRYV:
POPF

    RCR BYTE PTR [DI],CL

	 PUSHF
         JMP   CEXSH   
SHIFTARITHMATICRIGHTV:
POPF

    SAR BYTE PTR [DI],CL
 
	 PUSHF
         JMP   CEXSH   
             	
REGISH:
LEA DI, asciisourcesum
MOV BL,[DI]
CMP BL,8FH
JNZ ERRORSHA101
JZ VALUESH

ERRORSHA101:
JMP ERRORSHA100
REGISTERDESTSHA201:
JMP REGISTERDESTSHA200    
 ;/////////////////////////////////////////////////////////////////////////PART2    stackpointerreg        	   
REGISTERDESTSH:
CMP SOURCESELECTOR,3H
JZ ERRORSHA100
CMP SOURCEHIN,8H    ; 8-> VALUE 8 BIT  16-> VLAUE 16 REG OR 16 BIT VALUE  17-> 8 BIT REG
    
  JZ VALUESH2
  
   CMP SOURCEHIN,17H 
    
    JZ REGISH2
       
     CMP SOURCEHIN,16H 
   JZ ERRORSHA100 
   
   
REGISH2:         
LEA DI, asciisourcesum
MOV BL,[DI]
CMP BL,8FH
JNZ ERRORSHA100
JZ VALUESH2    
            
VALUESH2: 
   
   LEA DI ,asciidestsum
   MOV BL,[DI]
       
       CMP BL,99H 
       JZ RAXDSH99
       
       CMP BL,9AH
       JZ RBXDSH99 
       
       CMP BL,9BH
       JZ RCXDSH99
       
       CMP BL,9CH
       JZ RDXDSH99 
        
       CMP BL,0A3H
       JZ RSPDSH99 
        
       CMP BL,84H
       JZ RBBDSH99
       
       CMP BL,0A6H
       JZ RSIDSH99 
       
       CMP BL,92H
       JZ RDIDSH99  
       
       CMP BL,8DH
       JZ RALDSH99
       
       CMP BL,89H
       JZ RAHDSH99
       
       CMP BL,8EH
       JZ RBLDSH99   
       
       CMP BL,8AH
       JZ RBHDSH99  
       
       CMP BL,8FH
       JZ RCLLDSH99
       
       CMP BL,8BH
       JZ RCHDSH99
       
       CMP BL,90H
       JZ RDLDSH99
       
       CMP BL,8CH
       JZ RDHDSH99 
   
       
       JMP ERRORSH
RAXDSH99:
JMP RAXDSH       
ERRORSHA100:
JMP ERRORSHA99        
REGISTERDESTSHA200:
JMP REGISTERDESTSHA199                                        
RBXDSH99:
JMP RBXDSH
RCXDSH99:
JMP RCXDSH98
RDXDSH99:
JMP RDXDSH98
RSIDSH99:
JMP RSIDSH98
RDIDSH99:
JMP RDIDSH98
RSPDSH99:
JMP RSPDSH98
RBBDSH99:
JMP RBBDSH98
RALDSH99:
JMP RALDSH98
RBHDSH99:
JMP RBHDSH98
RBLDSH99:
JMP RBLDSH98
RAHDSH99:
JMP RAHDSH98
RCLLDSH99:
JMP RCLLDSH98
RCHDSH99:
JMP RCHDSH98
RDLDSH99:
JMP RDLDSH98
RDHDSH99:
JMP RDHDSH98


        
RAXDSH: 


   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVAX
     
     CMP BL,0E7H
     JZ SHIFTLEFTVAX   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVAX
     
      CMP BL,0F0H
     JZ ROTATELEFTVAX 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVAX
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVAX
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVAX 
      
    	
SHIFTRIGHTVAX: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR AX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH 
SHIFTLEFTVAX: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL AX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
ROTATERIGHTVAX: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR AX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH        
ROTATELEFTVAX:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL AX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
ROTATELEFTWITHCARRYVAX: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL AX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
ROTATERIGHTWITHCARRYVAX:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR AX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
SHIFTARITHMATICRIGHTVAX:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR AX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
         
RCXDSH98:
JMP RCXDSH
RDXDSH98:
JMP RDXDSH97
RSIDSH98:
JMP RSIDSH97
RDIDSH98:
JMP RDIDSH97
RSPDSH98:
JMP RSPDSH97
RBBDSH98:
JMP RBBDSH97
RALDSH98:
JMP RALDSH97
RBHDSH98:
JMP RBHDSH97
RBLDSH98:
JMP RBLDSH97
RAHDSH98:
JMP RAHDSH97
RCLLDSH98:
JMP RCLLDSH97
RCHDSH98:
JMP RCHDSH97
RDLDSH98:
JMP RDLDSH97
RDHDSH98:
JMP RDHDSH97
ERRORSHA99:
JMP ERRORSH
REGISTERDESTSHA199:
JMP REGISTERDESTSH
    
                        
RBXDSH: ;///////// BX 
	   LEA SI,asciisum
	   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVBX
     
     CMP BL,0E7H
     JZ SHIFTLEFTVBX   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVBX
     
      CMP BL,0F0H
     JZ ROTATELEFTVBX 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVBX
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVBX
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVBX 
      
    	
SHIFTRIGHTVBX: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR BX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH 
SHIFTLEFTVBX: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL BX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
ROTATERIGHTVBX: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR BX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH        
ROTATELEFTVBX:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL BX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
ROTATELEFTWITHCARRYVBX: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL BX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
ROTATERIGHTWITHCARRYVBX:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR BX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
SHIFTARITHMATICRIGHTVBX:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR BX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH


RDXDSH97:
JMP RDXDSH
RSIDSH97:
JMP RSIDSH96
RDIDSH97:
JMP RDIDSH96
RSPDSH97:
JMP RSPDSH96
RBBDSH97:
JMP RBBDSH96
RALDSH97:
JMP RALDSH96
RBHDSH97:
JMP RBHDSH96
RBLDSH97:
JMP RBLDSH96
RAHDSH97:
JMP RAHDSH96
RCLLDSH97:
JMP RCLLDSH96
RCHDSH97:
JMP RCHDSH96
RDLDSH97:
JMP RDLDSH96
RDHDSH97:
JMP RDHDSH96    
                
       
RCXDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVCX
     
     CMP BL,0E7H
     JZ SHIFTLEFTVCX   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVCX
     
      CMP BL,0F0H
     JZ ROTATELEFTVCX 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVCX
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVCX
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVCX97 
      
    	
SHIFTRIGHTVCX: ;1
POPF
POPA
MOV TEMPSHIFTROT2,CX

MOV CL,BYTE PTR FINALSOURCE
SHR TEMPSHIFTROT2,CL
MOV CX,TEMPSHIFTROT2
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
SHIFTLEFTVCX: ;2
POPF
POPA
MOV TEMPSHIFTROT2,CX

MOV CL,BYTE PTR FINALSOURCE
SHL TEMPSHIFTROT2,CL
MOV CX,TEMPSHIFTROT2
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTVCX: ;7
POPF
POPA
MOV TEMPSHIFTROT2,CX

MOV CL,BYTE PTR FINALSOURCE
ROR TEMPSHIFTROT2,CL
MOV CX,TEMPSHIFTROT2
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
SHIFTARITHMATICRIGHTVCX97:
JMP SHIFTARITHMATICRIGHTVCX                  
ROTATELEFTVCX:;3
POPF
POPA
MOV TEMPSHIFTROT2,CX

MOV CL,BYTE PTR FINALSOURCE
ROL TEMPSHIFTROT2,CL
MOV CX,TEMPSHIFTROT2
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH 
ROTATELEFTWITHCARRYVCX: ;4
POPF
POPA
MOV TEMPSHIFTROT2,CX

MOV CL,BYTE PTR FINALSOURCE
RCL TEMPSHIFTROT2,CL
MOV CX,TEMPSHIFTROT2
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH 
ROTATERIGHTWITHCARRYVCX:;5
POPF
POPA
MOV TEMPSHIFTROT2,CX

MOV CL,BYTE PTR FINALSOURCE
RCR TEMPSHIFTROT2,CL
MOV CX,TEMPSHIFTROT2
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
SHIFTARITHMATICRIGHTVCX:;6
POPF
POPA
MOV TEMPSHIFTROT2,CX

MOV CL,BYTE PTR FINALSOURCE
SAR TEMPSHIFTROT2,CL
MOV CX,TEMPSHIFTROT2
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
                           

RSIDSH96:
JMP RSIDSH
RDIDSH96:
JMP RDIDSH95
RSPDSH96:
JMP RSPDSH95
RBBDSH96:
JMP RBBDSH95
RALDSH96:
JMP RALDSH95
RBHDSH96:
JMP RBHDSH95
RBLDSH96:
JMP RBLDSH95
RAHDSH96:
JMP RAHDSH95
RCLLDSH96:
JMP RCLLDSH95
RCHDSH96:
JMP RCHDSH95
RDLDSH96:
JMP RDLDSH95
RDHDSH96:
JMP RDHDSH95
    
       
RDXDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVDX
     
     CMP BL,0E7H
     JZ SHIFTLEFTVDX   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVDX
     
      CMP BL,0F0H
     JZ ROTATELEFTVDX 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVDX
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVDX
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVDX 
      
    	
SHIFTRIGHTVDX: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR DX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH 
SHIFTLEFTVDX: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL DX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
ROTATERIGHTVDX: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR DX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH        
ROTATELEFTVDX:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL DX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
ROTATELEFTWITHCARRYVDX: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL DX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
ROTATERIGHTWITHCARRYVDX:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR DX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
SHIFTARITHMATICRIGHTVDX:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR DX,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
         
         
RDIDSH95:
JMP RDIDSH
RSPDSH95:
JMP RSPDSH94
RBBDSH95:
JMP RBBDSH94
RALDSH95:
JMP RALDSH94
RBHDSH95:
JMP RBHDSH94
RBLDSH95:
JMP RBLDSH94
RAHDSH95:
JMP RAHDSH94
RCLLDSH95:
JMP RCLLDSH94
RCHDSH95:
JMP RCHDSH94
RDLDSH95:
JMP RDLDSH94
RDHDSH95:
JMP RDHDSH94         


             
       
RSIDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVSI
     
     CMP BL,0E7H
     JZ SHIFTLEFTVSI   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVSI
     
      CMP BL,0F0H
     JZ ROTATELEFTVSI 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVSI
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVSI
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVSI 
      
    	
SHIFTRIGHTVSI: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR SI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH 
SHIFTLEFTVSI: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL SI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
ROTATERIGHTVSI: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR SI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH        
ROTATELEFTVSI:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL SI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVSI: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL SI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
ROTATERIGHTWITHCARRYVSI:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR SI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVSI:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR SI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH  
           
RSPDSH94:
JMP RSPDSH
RBBDSH94:
JMP RBBDSH93
RALDSH94:
JMP RALDSH93
RBHDSH94:
JMP RBHDSH93
RBLDSH94:
JMP RBLDSH93
RAHDSH94:
JMP RAHDSH93
RCLLDSH94:
JMP RCLLDSH93
RCHDSH94:
JMP RCHDSH93
RDLDSH94:
JMP RDLDSH93
RDHDSH94:
JMP RDHDSH93         

           
RDIDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVDI
     
     CMP BL,0E7H
     JZ SHIFTLEFTVDI   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVDI
     
      CMP BL,0F0H
     JZ ROTATELEFTVDI 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVDI
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVDI
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVDI 
      
    	
SHIFTRIGHTVDI: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR DI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH 
SHIFTLEFTVDI: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL DI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP   CEXSH
ROTATERIGHTVDI: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR DI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH        
ROTATELEFTVDI:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL DI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVDI: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL DI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVDI:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR DI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVDI:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR DI,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  CEXSH
                  
RBBDSH93:
JMP RBBDSH
RALDSH93:
JMP RALDSH92
RBHDSH93:
JMP RBHDSH92
RBLDSH93:
JMP RBLDSH92
RAHDSH93:
JMP RAHDSH92
RCLLDSH93:
JMP RCLLDSH92
RCHDSH93:
JMP RCHDSH92
RDLDSH93:
JMP RDLDSH92
RDHDSH93:
JMP RDHDSH92          

    
       
RSPDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVSP
     
     CMP BL,0E7H
     JZ SHIFTLEFTVSP   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVSP
     
      CMP BL,0F0H
     JZ ROTATELEFTVSP 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVSP
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVSP
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVSP 
      
    	
SHIFTRIGHTVSP:

	 popf
	LEA DI,stackpointerreg
	MOV AX,[DI]
	
    MOV CL,BYTE PTR FINALSOURCE 
    SHR AX,CL
    MOV [DI],AX
	 pushf
	 JMP CEXSH  
SHIFTLEFTVSP:

	 popf
	LEA DI,stackpointerreg
	MOV AX,[DI]
	MOV CL,BYTE PTR FINALSOURCE 
    SHL AX,CL
    MOV [DI],AX
	 pushf
	 JMP   CEXSH
ROTATELEFTVSP:

	 popf
	LEA DI,stackpointerreg
	MOV AX,[DI]
	MOV CL,BYTE PTR FINALSOURCE 
    ROL AX,CL
    MOV [DI],AX
	 pushf
	 JMP   CEXSH  
ROTATERIGHTVSP:

	 popf
	LEA DI,stackpointerreg
	MOV AX,[DI]
	MOV CL,BYTE PTR FINALSOURCE 
    ROR AX,CL
    MOV [DI],AX
	 pushf
	 JMP  CEXSH 
ROTATELEFTWITHCARRYVSP:

	 popf
	LEA DI,stackpointerreg
	MOV AX,[DI]
	MOV CL,BYTE PTR FINALSOURCE 
    RCL AX,CL
    MOV [DI],AX
	 pushf
	 JMP  CEXSH 
ROTATERIGHTWITHCARRYVSP:

	 popf
	LEA DI,stackpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    RCR AX,CL
    MOV [DI],AX
	 pushf 
SHIFTARITHMATICRIGHTVSP:

	 popf
	LEA DI,stackpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    SAR AX,CL
    MOV [DI],AX
	 pushf 
	 JMP CEXSH        
	
RALDSH92:
JMP RALDSH
RBHDSH92:
JMP RBHDSH91
RBLDSH92:
JMP RBLDSH91
RAHDSH92:
JMP RAHDSH91
RCLLDSH92:
JMP RCLLDSH91
RCHDSH92:
JMP RCHDSH91
RDLDSH92:
JMP RDLDSH91
RDHDSH92:
JMP RDHDSH91          
         

             
RBBDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVBP
     
     CMP BL,0E7H
     JZ SHIFTLEFTVBP   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVBP
     
      CMP BL,0F0H
     JZ ROTATELEFTVBP 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVBP
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVBP
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVBP 
      
    	
SHIFTRIGHTVBP: ;1

	 popf
	LEA DI,BASEpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    SHR AX,CL
    MOV [DI],AX
	 pushf 
	 JMP CEXSH 
SHIFTLEFTVBP: ;2
 popf
	LEA DI,BASEpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    SHL AX,CL
    MOV [DI],AX
	 pushf 
	 JMP CEXSH 
ROTATERIGHTVBP: ;7
 popf
	LEA DI,BASEpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    ROR AX,CL
    MOV [DI],AX
	 pushf 
	 JMP CEXSH         
ROTATELEFTVBP:;3
 popf
	LEA DI,BASEpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    ROL AX,CL
    MOV [DI],AX
	 pushf 
	 JMP CEXSH 
ROTATELEFTWITHCARRYVBP: ;4
 popf
	LEA DI,BASEpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    RCL AX,CL
    MOV [DI],AX
	 pushf 
	 JMP CEXSH 
ROTATERIGHTWITHCARRYVBP:;5
 popf
	LEA DI,BASEpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    RCR AX,CL
    MOV [DI],AX
	 pushf 
	 JMP CEXSH 
SHIFTARITHMATICRIGHTVBP:;6
 popf
	LEA DI,BASEpointerreg
	MOV AX,[DI] 
	MOV CL,BYTE PTR FINALSOURCE
    SAR AX,CL
    MOV [DI],AX
	 pushf 
	 JMP CEXSH 
         
RBHDSH91:
JMP RBHDSH
RBLDSH91:
JMP RBLDSH90
RAHDSH91:
JMP RAHDSH90
RCLLDSH91:
JMP RCLLDSH90
RCHDSH91:
JMP RCHDSH90
RDLDSH91:
JMP RDLDSH90
RDHDSH91:
JMP RDHDSH90 
         
RALDSH: 
            LEA SI,asciisum
            MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVAL
     
     CMP BL,0E7H
     JZ SHIFTLEFTVAL   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVAL
     
      CMP BL,0F0H
     JZ ROTATELEFTVAL 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVAL
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVAL
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVAL98 
      
    	
SHIFTRIGHTVAL: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR AL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP FAR PTR   CEXSH 
SHIFTLEFTVAL: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL AL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP  FAR PTR  CEXSH
ROTATERIGHTVAL: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR AL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
          
SHIFTARITHMATICRIGHTVAL98:
JMP SHIFTARITHMATICRIGHTVAL
                
ROTATELEFTVAL:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL AL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVAL: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL AL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVAL:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR AL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVAL:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR AL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
         
RBLDSH90:
JMP RBLDSH
RAHDSH90:
JMP RAHDSH89
RCLLDSH90:
JMP RCLLDSH89
RCHDSH90:
JMP RCHDSH89
RDLDSH90:
JMP RDLDSH89
RDHDSH90:
JMP RDHDSH89          

RBHDSH: 
    LEA SI,asciisum
    MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVBH
     
     CMP BL,0E7H
     JZ SHIFTLEFTVBH   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVBH
     
      CMP BL,0F0H
     JZ ROTATELEFTVBH 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVBH
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVBH
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVBH 
      
    	
SHIFTRIGHTVBH: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR BH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH 
SHIFTLEFTVBH: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL BH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTVBH: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR BH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH        
ROTATELEFTVBH:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL BH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVBH: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL BH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVBH:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR BH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVBH:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR BH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
         
RAHDSH89:
JMP RAHDSH
RCLLDSH89:
JMP RCLLDSH88
RCHDSH89:
JMP RCHDSH88
RDLDSH89:
JMP RDLDSH88
RDHDSH89:
JMP RDHDSH88         

             
RBLDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVBL
     
     CMP BL,0E7H
     JZ SHIFTLEFTVBL   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVBL
     
      CMP BL,0F0H
     JZ ROTATELEFTVBL 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVBL
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVBL
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVBL 
      
    	
SHIFTRIGHTVBL: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR BL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH 
SHIFTLEFTVBL: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL BL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTVBL: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR BL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH        
ROTATELEFTVBL:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL BL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVBL: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL BL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVBL:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR BL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVBL:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR BL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
         
RCLLDSH88:
JMP RCLLDSH
RCHDSH88:
JMP RCHDSH87
RDLDSH88:
JMP RDLDSH87
RDHDSH88:
JMP RDHDSH87  

             
RAHDSH:
    LEA SI,asciisum
    MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVAH
     
     CMP BL,0E7H
     JZ SHIFTLEFTVAH   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVAH
     
      CMP BL,0F0H
     JZ ROTATELEFTVAH 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVAH
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVAH
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVAH 
      
    	
SHIFTRIGHTVAH: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR AH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH 
SHIFTLEFTVAH: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL AH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTVAH: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR AH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH        
ROTATELEFTVAH:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL AH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVAH: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL AH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVAH:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR AH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVAH:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR AH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
                  
RCHDSH87:
JMP RCHDSH
RDLDSH87:
JMP RDLDSH86
RDHDSH87:
JMP RDHDSH86 

    
RCLLDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVCL
     
     CMP BL,0E7H
     JZ SHIFTLEFTVCL   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVCL
     
      CMP BL,0F0H
     JZ ROTATELEFTVCL 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVCL
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVCL
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVCL99 
      
SHIFTRIGHTVCL: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL

MOV CL,BYTE PTR FINALSOURCE
SHR TEMPSHIFTROT,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
         
SHIFTLEFTVCL: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL

MOV CL,BYTE PTR FINALSOURCE
SHL TEMPSHIFTROT,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTVCL: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL

MOV CL,BYTE PTR FINALSOURCE
ROR TEMPSHIFTROT,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
         
SHIFTARITHMATICRIGHTVCL99:
JMP SHIFTARITHMATICRIGHTVCL
                
ROTATELEFTVCL:;3
POPF
POPA
MOV TEMPSHIFTROT,CL

MOV CL,BYTE PTR FINALSOURCE
ROL TEMPSHIFTROT,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVCL: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL

MOV CL,BYTE PTR FINALSOURCE
RCL TEMPSHIFTROT,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVCL:;5
POPF
POPA
MOV TEMPSHIFTROT,CL

MOV CL,BYTE PTR FINALSOURCE
RCR TEMPSHIFTROT,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVCL:;6
POPF
POPA
MOV TEMPSHIFTROT,CL

MOV CL,BYTE PTR FINALSOURCE
SAR TEMPSHIFTROT,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH  
         
RDLDSH86:
JMP RDLDSH
RDHDSH86:
JMP RDHDSH85                   

RCHDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVCH
     
     CMP BL,0E7H
     JZ SHIFTLEFTVCH   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVCH
     
      CMP BL,0F0H
     JZ ROTATELEFTVCH 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVCH
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVCH
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVCH 
      
    	
SHIFTRIGHTVCH: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR CH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH 
SHIFTLEFTVCH: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL CH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTVCH: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR CH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH        
ROTATELEFTVCH:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL CH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVCH: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL CH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVCH:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR CH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVCH:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR CH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
                  
         
RDHDSH85:
JMP RDHDSH
    
RDHDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVDH
     
     CMP BL,0E7H
     JZ SHIFTLEFTVDH   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVDH
     
      CMP BL,0F0H
     JZ ROTATELEFTVDH 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVDH
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVDH
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVDH 
      
    	
SHIFTRIGHTVDH: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR DH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH 
SHIFTLEFTVDH: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL DH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTVDH: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR DH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH        
ROTATELEFTVDH:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL DH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVDH: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL DH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVDH:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR DH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVDH:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR DH,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH 
         
         

        
RDLDSH:
   LEA SI,asciisum
   MOV BL,[SI]
     cmp BL,0EDH
     JZ SHIFTRIGHTVDL
     
     CMP BL,0E7H
     JZ SHIFTLEFTVDL   
     
      CMP BL,0EFH
     JZ ROTATERIGHTVDL
     
      CMP BL,0F0H
     JZ ROTATELEFTVDL 
     
     CMP BL,0E1H
     JZ ROTATELEFTWITHCARRYVDL
     
     CMP BL,0E5H
     JZ ROTATERIGHTWITHCARRYVDL
     
     CMP BL,0E6H
     JZ SHIFTARITHMATICRIGHTVDL 
      
    	
SHIFTRIGHTVDL: ;1
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHR DL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH 
SHIFTLEFTVDL: ;2
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SHL DL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTVDL: ;7
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROR DL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH        
ROTATELEFTVDL:;3
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
ROL DL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATELEFTWITHCARRYVDL: ;4
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCL DL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
ROTATERIGHTWITHCARRYVDL:;5
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
RCR DL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH
SHIFTARITHMATICRIGHTVDL:;6
POPF
POPA
MOV TEMPSHIFTROT,CL
MOV CL,BYTE PTR FINALSOURCE
SAR DL,CL
MOV CL,TEMPSHIFTROT
    
	  PUSHA 
	 PUSHF
         JMP CEXSH


    
ERRORSH:
MOV ERRORFLAG,1H 
      MOV CX,5
      
    L44SH1:  
    MOV AH,2
    MOV DL,7
    INT 21H 
    LOOP L44SH1  
    MOV ERRORFLAG,1H
     
    CEXSH:
ENDM CSHIFTROTMACRO    
Display Macro MSG
    MOV AH,9
    LEA DX,MSG
    INT 21H
ENDM

FKUSED Macro 
LOCAL loopFKUSED
LOCAL      USED
LOCAL      EXFKUSED 
lea si,commands
add si,2
MOV AL,FK
mov cx,16
loopFKUSED:
CMP BYTE PTR [SI],AL   
JZ USED
INC SI
LOOP loopFKUSED
JMP EXFKUSED

USED:
MOV FKUSEDFLAG,1H

EXFKUSED:
   
ENDM 


FKUSEDONBOTH Macro 
LOCAL loopFKUSED
LOCAL      USED
LOCAL      EXFKUSED 
lea si,commands
add si,2
MOV AL,FKOPPONENT
mov cx,16
loopFKUSED:
CMP BYTE PTR [SI],AL   
JZ USED
INC SI
LOOP loopFKUSED
JMP EXFKUSED

USED:
MOV FKUSEDFLAG,1H

EXFKUSED:
   
ENDM


TURNFROMASCII MACRO INPUTONLYLETER   
   LOCAL NUMBERTURNFROMASCII
     LOCAL SMALLETERTURNFROMASCII
      LOCAL  EXTURNFROMASCII
      LOCAL  A
      LOCAL   B
      LOCAL    C
      LOCAL     D
      LOCAL      E
      LOCAL       F
      LOCAL  CHANGELETERSONLY
    
    
    MOV AL,BYTE PTR INPUTONLYLETER
    
    CMP AL,3AH
    JC NUMBERTURNFROMASCII
    
    CMP AL,5BH
    JNC SMALLETERTURNFROMASCII
    JMP CHANGELETERSONLY
    
NUMBERTURNFROMASCII:
SUB AL,30H
MOV BYTE PTR INPUTONLYLETER,AL
JMP EXTURNFROMASCII
    
SMALLETERTURNFROMASCII:
SUB AL,20H
MOV BYTE PTR INPUTONLYLETER,AL
JMP CHANGELETERSONLY
     
CHANGELETERSONLY:
MOV BYTE PTR INPUTONLYLETER,AL
 
 CMP BYTE PTR INPUTONLYLETER,'A'
       JNZ B
       MOV BYTE PTR INPUTONLYLETER,0AH
       JMP EXTURNFROMASCII
       
B:
       CMP BYTE PTR INPUTONLYLETER,'B'
       JNZ C
       MOV BYTE PTR INPUTONLYLETER,0BH  
       JMP EXTURNFROMASCII 
        
C:
       CMP BYTE PTR  INPUTONLYLETER,'C'
       JNZ D
       MOV BYTE PTR  INPUTONLYLETER,0CH
       JMP EXTURNFROMASCII 
        
D:
       CMP BYTE PTR INPUTONLYLETER,'D'
       JNZ E
       MOV BYTE PTR INPUTONLYLETER,0DH
       JMP EXTURNFROMASCII 
        
E:
       CMP BYTE PTR INPUTONLYLETER,'E'
       JNZ F
       MOV BYTE PTR INPUTONLYLETER,0EH 
       JMP EXTURNFROMASCII 
F:      
       CMP BYTE PTR INPUTONLYLETER,'F'
       MOV BYTE PTR INPUTONLYLETER,0FH
       JMP EXTURNFROMASCII

EXTURNFROMASCII:

    
 
    


ENDM  




TURNTOASCIIFK MACRO INPUTONLYLETER   
   LOCAL NUMBERTURNFROMASCIIFK
     LOCAL SMALLETERTURNFROMASCIIFK
      LOCAL  EXTURNFROMASCIIFK
      LOCAL  AFK
      LOCAL   BFK
      LOCAL    CFK
      LOCAL     DFK
      LOCAL      EFK
      LOCAL       FFK
      
    
    
    MOV AL,BYTE PTR INPUTONLYLETER
    
    CMP AL,3AH
    JC NUMBERTURNFROMASCIIFK
    
    CMP AL,5BH
    JNC SMALLETERTURNFROMASCIIFK
    JMP EXTURNFROMASCIIFK
    
NUMBERTURNFROMASCIIFK:
;SUB AL,30H
MOV BYTE PTR INPUTONLYLETER,AL
JMP EXTURNFROMASCIIFK
    
SMALLETERTURNFROMASCIIFK:
SUB AL,20H
MOV BYTE PTR INPUTONLYLETER,AL
JMP EXTURNFROMASCIIFK
     

EXTURNFROMASCIIFK:

    
 
    


ENDM


read3 macro iinput
      mov  dl, 4h   ;Column
      mov  dh, 11h   ;Row
      mov  bh, 0    ;Display page
      mov  ah, 02h  ;SetCursorPosition
      int  10h
      mov ah,0ah
      mov dx,offset iinput
      int 21h
endm

Read2 Macro Input
   
    MOV AH,0AH
    MOV DX,OFFSET Input
    INT 21H
ENDM

read macro commands

LEA si,commands
mov  dl, 4h   ;Column
mov  dh, 11h   ;Row
mov  bh, 0    ;Display page
mov  ah, 02h  ;SetCursorPosition
int  10h

;mov cx,13
loopp:
mov ah,07H
int 21h 
cmp al,0Dh
jz eex
mov [si]+2,al
mov  bl, 0ch  ;Color is red
mov  bh, 0    ;Display page
mov  ah, 0Eh  ;Teletype
int  10h ; display character in graphics mode with 10*10 pixel for single character
inc si
loop loopp

endm

CHANGEGAMETARGET MACRO 
 CMP ONLYONCETARGETVALUE,1H
    JZ  EXCHANGEGAMETARGETKK
    JMP CONTINUETG
    EXCHANGEGAMETARGETKK:
    JMP EXCHANGEGAMETARGET
CONTINUETG:
    MOV AH,0H
    INT 16H
    
    MOV BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    
    MOV BYTE PTR  THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    
    MOV BYTE PTR  SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    
    MOV  BYTE PTR FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV TEMPTARGETVALUE,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD TEMPTARGETVALUE,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD TEMPTARGETVALUE,AX
    MOV AX,FIRSTDIGIT
    ADD TEMPTARGETVALUE,AX
    
    POPF
    POPA
    PUSHA
    PUSHF
    
    
    CMP AX,TEMPTARGETVALUE
    JZ EXCHANGEGAMETARGET
    CMP BX,TEMPTARGETVALUE
    JZ EXCHANGEGAMETARGET
    CMP CX,TEMPTARGETVALUE
    JZ EXCHANGEGAMETARGET
    CMP DX,TEMPTARGETVALUE
    JZ EXCHANGEGAMETARGET
    CMP SI,TEMPTARGETVALUE
    JZ EXCHANGEGAMETARGET
    CMP DI,TEMPTARGETVALUE
    JZ EXCHANGEGAMETARGET
    MOV AX,stackpointerreg
    CMP AX,TEMPTARGETVALUE
    JZ EXCHANGEGAMETARGET
    MOV AX,BASEpointerreg
    CMP AX,TEMPTARGETVALUE
    JZ EXCHANGEGAMETARGET
    JMP CHANGEEEEEEEEEEE
    
CHANGEEEEEEEEEEE:

MOV ONLYONCETARGETVALUE,1H
MOV AX, TEMPTARGETVALUE
MOV TARGETVALUE,AX
JMP EXCHANGEGAMETARGET   

EXCHANGEGAMETARGET:    
       
    
    ENDM

LEVEL2INITIALIZATION MACRO
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV AXL2,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD AXL2,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD AXL2,AX
    MOV AX,FIRSTDIGIT
    ADD AXL2,AX
    DISPLAY NEWLINE
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV BXL2,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD BXL2,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD BXL2,AX
    MOV AX,FIRSTDIGIT
    ADD BXL2,AX
    DISPLAY NEWLINE
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR  FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV CXL2,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD CXL2,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD CXL2,AX
    MOV AX,FIRSTDIGIT
    ADD CXL2,AX
    DISPLAY NEWLINE
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV DXL2,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD DXL2,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD DXL2,AX
    MOV AX,FIRSTDIGIT
    ADD DXL2,AX
    DISPLAY NEWLINE
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV SIL2,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD SIL2,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD SIL2,AX
    MOV AX,FIRSTDIGIT
    ADD SIL2,AX
    DISPLAY NEWLINE
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV BYTE PTR  FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV DIL2,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD DIL2,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD DIL2,AX
    MOV AX,FIRSTDIGIT
    ADD DIL2,AX
    DISPLAY NEWLINE
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV SPL2,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD SPL2,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD SPL2,AX
    MOV AX,FIRSTDIGIT
    ADD SPL2,AX
    DISPLAY NEWLINE
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FORTHDIGIT,AL
    TURNFROMASCII FORTHDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR THIRDDIGIT,AL
    TURNFROMASCII THIRDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR SECONDDIGIT,AL
    TURNFROMASCII SECONDDIGIT
    MOV AH,0H
    INT 16H
    MOV AH,2H
    MOV DL,AL
    INT 21H
    MOV  BYTE PTR FIRSTDIGIT,AL
    TURNFROMASCII FIRSTDIGIT
    MOV AX,1000H
    MUL FORTHDIGIT
    MOV BPL2,AX
    MOV AX,100H
    MUL THIRDDIGIT
    ADD BPL2,AX
    MOV AX,10H
    MUL SECONDDIGIT
    ADD BPL2,AX
    MOV AX,FIRSTDIGIT
    ADD BPL2,AX
    ;DISPLAY NEWLINE
ENDM 

 
LOSERMACRO MACRO
       MOV AH,0H
    MOV AL,13H              
    INT 10H 
    MOV BH,0
    MOV DL,0bH
    MOV DH,0bH
    MOV AH,2H
    INT 10H
    MOV AH,9H
    LEA DX,MESLOS
    INT 21H
    mov SI,0h
    lloopp2LOS:
    mov ah,2Ch 
    int 21h 
    cmp dh,time
    jz lloopp2LOS
    mov time,dh
    inc SI
    cmp SI,04h
    jz ex22LOS 
    jmp lloopp2LOS
    ex22LOS:
    MOV AH,0H
    MOV AL,13H              
    INT 10H 
    HLT
    
ENDM